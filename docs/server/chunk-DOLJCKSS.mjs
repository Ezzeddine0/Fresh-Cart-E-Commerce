import './polyfills.server.mjs';
import{a as P}from"./chunk-DBXTZLTR.mjs";import{a as S,b as l,c as y,d as E,f as L,g as x,h as M,i as T,k as V}from"./chunk-TQFFRULN.mjs";import"./chunk-EF2HFKWS.mjs";import{d as b}from"./chunk-CESV4JBY.mjs";import"./chunk-P6M526BC.mjs";import{Db as n,Eb as v,Lb as F,Na as s,V as w,Z as C,cb as u,eb as c,ib as a,mb as o,nb as i,ob as g,tb as h,ub as _}from"./chunk-VSZ2F6JD.mjs";import"./chunk-VVCT4QZE.mjs";function R(e,p){if(e&1&&(o(0,"p",6),n(1),i()),e&2){let r=_();s(),v(r.errorMessage)}}function B(e,p){e&1&&(o(0,"span"),g(1,"i",18),i())}function N(e,p){if(e&1&&(o(0,"p",6),n(1),i()),e&2){let r=_();s(),v(r.errorMessage)}}function A(e,p){e&1&&(o(0,"span"),g(1,"i",18),i())}function I(e,p){e&1&&(o(0,"p",6),n(1,"Enter a valid Email."),i())}function G(e,p){e&1&&(o(0,"p",6),n(1,"Enter a valid password."),i())}function D(e,p){e&1&&(o(0,"p",17),n(1,"Password has been reseted succefully."),i())}function q(e,p){if(e&1&&(o(0,"p",6),n(1),i()),e&2){let r=_();s(),v(r.errorMessage)}}function k(e,p){e&1&&(o(0,"span"),g(1,"i",18),i())}var Q=(()=>{class e{constructor(){this._AuthService=w(P),this._FormBuilder=w(T),this._Router=w(b),this.isLoading=!1,this.errorMessage="",this.success=!1,this.forgetPasswordForm=this._FormBuilder.group({email:[null,[l.email,l.required]]}),this.resetCodeVerifyForm=this._FormBuilder.group({resetCode:[null,[l.required,l.minLength(6),l.maxLength(6)]]}),this.resetPasswordForm=this._FormBuilder.group({email:[null,[l.email,l.required]],newPassword:[null,[l.required,l.pattern(/^\w{6,}$/)]]})}forgetPassword(){if(this.forgetPasswordForm.valid){let r=this.forgetPasswordForm.value.email;this.resetPasswordForm.get("email")?.patchValue(r),this.errorMessage="",this.isLoading=!0,this.forgetPasswordSub=this._AuthService.forgetPsssword(this.forgetPasswordForm.value).subscribe({next:d=>{this.isLoading=!1,this.errorMessage="",d.data,document.getElementById("forgetPassword")?.classList.add("d-none"),document.getElementById("verifyResetCode")?.classList.remove("d-none")},error:d=>{this.isLoading=!1,this.errorMessage=d.error.message,console.log(d)}})}}resetCode(){console.log(this.resetCodeVerifyForm.value),this.resetCodeVerifyForm.valid&&(this.isLoading=!0,this.resetCodeSub=this._AuthService.verifyResetCode(this.resetCodeVerifyForm.value).subscribe({next:r=>{this.isLoading=!1,this.errorMessage="",console.log(r),document.getElementById("verifyResetCode")?.classList.add("d-none"),document.getElementById("resetPassword")?.classList.remove("d-none")},error:r=>{console.log(r),this.isLoading=!1,this.errorMessage=r.error.message}}))}resetPassword(){console.log(this.resetPasswordForm),this.isLoading=!0,this.resetPasswordSub=this._AuthService.ResetPassword(this.resetPasswordForm.value).subscribe({next:r=>{this.success=!0,this.errorMessage="",setTimeout(()=>{this._Router.navigate(["login"])},2e3),console.log(r)},error:r=>{this.isLoading=!1,console.log(r),this.errorMessage=r.error.message}})}ngOnDestroy(){this.forgetPasswordSub.unsubscribe(),this.resetCodeSub.unsubscribe(),this.resetPasswordSub.unsubscribe()}static{this.\u0275fac=function(d){return new(d||e)}}static{this.\u0275cmp=C({type:e,selectors:[["app-forgetpassword"]],standalone:!0,features:[F],decls:44,vars:15,consts:[[1,"bg-main-light","shadow","show","p-5","my-3","rounded"],["id","forgetPassword",1,""],[1,"text-main","mb-3"],[3,"ngSubmit","formGroup"],["for","email"],["type","email","name","email","id","email","formControlName","email",1,"form-control"],[1,"alert","alert-danger"],["type","submit",1,"btn-main","mt-4","ms-auto","d-block",3,"disabled"],["id","verifyResetCode",1,"d-none"],["for","resetCode",1,"h6"],["id","resetCode","name","resetCode","formControlName","resetCode","type","text",1,"form-control"],["type","submit",1,"btn-main","d-block","ms-auto","mt-3",3,"disabled"],["id","resetPassword",1,"d-none"],[1,"mb-3"],["readonly","","type","email","name","email","id","email","formControlName","email",1,"form-control"],["for","newPassword"],["type","password","name","newPassword","id","newPassword","formControlName","newPassword",1,"form-control"],[1,"alert","alert-success"],[1,"fas","fa-spin","fa-spinner"]],template:function(d,t){if(d&1&&(o(0,"section",0)(1,"div",1)(2,"h2",2),n(3,"Forget Password"),i(),o(4,"form",3),h("ngSubmit",function(){return t.forgetPassword()}),o(5,"div")(6,"label",4),n(7,"Email Address:"),i(),g(8,"input",5),i(),u(9,R,2,1,"p",6),o(10,"button",7),n(11," Forget "),u(12,B,2,0,"span"),i()()(),o(13,"div",8)(14,"h2",2),n(15,"Verify Code:"),i(),o(16,"form",3),h("ngSubmit",function(){return t.resetCode()}),o(17,"div")(18,"label",9),n(19,"Enter the code sent to your email:"),i(),g(20,"input",10),i(),u(21,N,2,1,"p",6),o(22,"button",11),n(23," verify "),u(24,A,2,0,"span"),i()()(),o(25,"div",12)(26,"h2",2),n(27,"Reset Password"),i(),o(28,"form",3),h("ngSubmit",function(){return t.resetPassword()}),o(29,"div",13)(30,"label",4),n(31,"Email Address:"),i(),g(32,"input",14),u(33,I,2,0,"p",6),i(),o(34,"div")(35,"label",15),n(36,"newPassword:"),i(),g(37,"input",16),u(38,G,2,0,"p",6),i(),u(39,D,2,0,"p",17)(40,q,2,1,"p",6),o(41,"button",7),n(42," Forget "),u(43,k,2,0,"span"),i()()()()),d&2){let m,f;s(4),c("formGroup",t.forgetPasswordForm),s(5),a(9,t.errorMessage?9:-1),s(),c("disabled",t.forgetPasswordForm.invalid||t.isLoading),s(2),a(12,t.isLoading?12:-1),s(4),c("formGroup",t.resetCodeVerifyForm),s(5),a(21,t.errorMessage?21:-1),s(),c("disabled",t.resetCodeVerifyForm.invalid||t.isLoading),s(2),a(24,t.isLoading?24:-1),s(4),c("formGroup",t.resetPasswordForm),s(5),a(33,(m=t.resetPasswordForm.get("email"))!=null&&m.errors&&((m=t.resetPasswordForm.get("email"))!=null&&m.touched||(m=t.resetPasswordForm.get("email"))!=null&&m.dirty)?33:-1),s(5),a(38,(f=t.resetPasswordForm.get("newPassword"))!=null&&f.errors&&((f=t.resetPasswordForm.get("newPassword"))!=null&&f.touched||(f=t.resetPasswordForm.get("newPassword"))!=null&&f.dirty)?38:-1),s(),a(39,t.success?39:-1),s(),a(40,t.errorMessage?40:-1),s(),c("disabled",t.resetPasswordForm.invalid||t.isLoading),s(2),a(43,t.isLoading?43:-1)}},dependencies:[V,L,S,y,E,x,M]})}}return e})();export{Q as ForgetpasswordComponent};
